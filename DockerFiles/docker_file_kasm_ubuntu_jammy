FROM kasmweb/ubuntu-jammy-desktop:1.14.0-rolling
USER root
ENV HOME /home/kasm-default-profile
ENV STARTUPDIR /dockerstartup
ENV INST_SCRIPTS $STARTUPDIR/install
WORKDIR $HOME


######### Customize Container Here ###########
ARG KUH=/home/kasm-user
RUN apt-get update && apt-get upgrade -y && \
    apt-get install -y libomp5 && \
    apt-get install -y sudo zsh && \
    rm -rf /var/lib/apt/list/* && \
    echo 'kasm-user ALL=(ALL) NOPASSWD: ALL' >> /etc/sudoers && \
    true

######### End Customizations ###########


RUN chown 1000:0 $HOME
RUN $STARTUPDIR/set_user_permission.sh $HOME
ENV HOME /home/kasm-user
WORKDIR $HOME
RUN mkdir -p $HOME && chown -R 1000:0 $HOME
USER 1000
